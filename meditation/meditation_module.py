# Main loop and entry point